(this["webpackJsonpproyecto-web"]=this["webpackJsonpproyecto-web"]||[]).push([[0],{40:function(e,t,c){},72:function(e,t,c){"use strict";c.r(t);var a=c(0),n=c.n(a),r=c(20),s=c.n(r),o=(c(40),c(23)),i=c(2),l=c(4),u=c.n(l),d=c(8),j=c(9),p=c.n(j),b=c(12),m=(c(33),c(10)),x=c(11),h=c(1),f=function(){var e=Object(i.g)(),t=Object(a.useRef)(null),c=Object(a.useRef)(null);function n(){return(n=Object(d.a)(u.a.mark((function a(n){var r,s,o,i,l;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),r=t.current.value,s=c.current.value,r&&s){a.next=6;break}return Object(b.b)("Campos vacios",{type:"warning"}),a.abrupt("return");case 6:return a.prev=6,a.next=9,p.a.post("https://posts-pw2021.herokuapp.com/api/v1/auth/signin",{username:r,password:s});case 9:200===(o=a.sent).status&&(localStorage.setItem("token",o.data.token),localStorage.setItem("rol",o.data.role),e("/")),a.next=19;break;case 13:a.prev=13,a.t0=a.catch(6),i=a.t0.response,l="",401===i.status?l="Datos incorrectos":500===i.status?l="Error servidor":404===i.status&&(l="Usuario no existe"),Object(b.b)(l,{type:"error"});case 19:case"end":return a.stop()}}),a,null,[[6,13]])})))).apply(this,arguments)}return Object(h.jsxs)("form",{className:"flex flex-col items-center justify-center w-screen h-screen",onSubmit:function(e){return n.apply(this,arguments)},children:[Object(h.jsx)(b.a,{}),Object(h.jsxs)("div",{className:"space-y-7 text-center border border-gray-500 p-7 text-xl",children:[Object(h.jsxs)("div",{className:"flex flex-col space-y-3",children:[Object(h.jsxs)("label",{htmlFor:"user-label",children:[Object(h.jsx)(m.a,{icon:x.e,size:"lg",className:"mr-2"}),"Usuario"]}),Object(h.jsx)("input",{className:"rounded-md p-2 border",type:"text",id:"user-input",placeholder:"usuario",ref:t})]}),Object(h.jsxs)("div",{className:"flex flex-col space-y-3",children:[Object(h.jsxs)("label",{htmlFor:"pass-label",children:[Object(h.jsx)(m.a,{icon:x.d,size:"lg",className:"mr-2"}),"Contrase\xf1a"]}),Object(h.jsx)("input",{className:"rounded-md p-2 border",type:"password",id:"pass-input",placeholder:"Contrase\xf1a",ref:c})]}),Object(h.jsx)("button",{className:"bg-green-500 text-white p-3 rounded-lg",type:"submit",children:"Iniciar sesion"})]})]})},O=c(5),g=function(){return Object(h.jsx)("div",{className:" h-screen w-screen justify-center items-center absolute top-0 left-0 z-20 flex h-screen w-screen bg-gray-700 bg-opacity-30",children:Object(h.jsx)(m.a,{icon:x.c,spin:!0,size:"3x",className:"text-green-500"})})},v=c(14),y=c(35),w=function(e){var t=e.info,c=t.description,a=t.user;return Object(h.jsxs)("div",{className:"border rounded-md p-2 m-2 border-green-700",children:[Object(h.jsx)("h1",{className:"text-xs",children:null===a||void 0===a?void 0:a.username}),Object(h.jsx)("p",{children:c})]})},N=function(e){var t=e.post,c=e.afterSubmit,n=Object(a.useState)(""),r=Object(O.a)(n,2),s=r[0],o=r[1];function i(){return(i=Object(d.a)(u.a.mark((function e(a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n={description:s},e.prev=2,e.next=5,p.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/comment/".concat(t),n,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log(e.t0);case 10:o(""),c(n);case 12:case"end":return e.stop()}}),e,null,[[2,7]])})))).apply(this,arguments)}return Object(h.jsx)("form",{className:"rounded-md p-2 m-2 border-green-700",onSubmit:function(e){return i.apply(this,arguments)},children:Object(h.jsx)("input",{value:s,onChange:function(e){o(e.target.value)},className:"border w-full rounded-md",type:"text",minLength:"8",maxLength:"32",placeholder:"Comentario"})})},k=c(34),S=c.n(k),I=function(e){var t=e.username,c=e.struct,n=c._id,r=c.title,s=c.description,o=c.image,i=c.user,l=c.createdAt,j=c.likes,b=c.comments,f=Object(a.useState)(!1),g=Object(O.a)(f,2),k=g[0],I=g[1],B=Object(a.useState)(b),z=Object(O.a)(B,2),C=z[0],D=z[1],E=Object(a.useState)(j.some((function(e){return e.username===t}))),F=Object(O.a)(E,2),A=F[0],L=F[1],J=Object(a.useState)(j.length),R=Object(O.a)(J,2),T=R[0],U=R[1];function _(){return(_=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.patch("https://posts-pw2021.herokuapp.com/api/v1/post/like/".concat(n),null,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:A?(U(T-1),L(!1)):(U(T+1),L(!0));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsxs)("div",{className:"bg-green-200 rounded-xl w-72 p-5 m-3",children:[Object(h.jsxs)("div",{className:"w-full flex font-bold border border-gray-700 rounded-md p-3",children:[Object(h.jsx)("h1",{className:"w-1/2",children:null===i||void 0===i?void 0:i.username}),Object(h.jsx)("h2",{className:"w-1/2 text-right",children:new Date(l).toLocaleDateString()})]}),o&&Object(h.jsx)("img",{className:"w-64 h-40 object-cover my-3 rounded-md",src:o,alt:"imagen"}),Object(h.jsxs)("div",{className:"w-full flex flex-col p-3 space-y-2",children:[Object(h.jsxs)("h1",{className:"text-xs font-bold",children:[" ",r," "]}),Object(h.jsxs)("h2",{className:"text-center text-sm",children:[" ",s," "]})]}),Object(h.jsxs)("div",{className:"w-full flex justify-around",children:[Object(h.jsxs)("button",{onClick:function(){return _.apply(this,arguments)},type:"button",className:"flex justify-center items-center ".concat(A&&"text-green-500"),children:[Object(h.jsx)(m.a,{icon:x.b,className:"mr-2"})," ",T]}),Object(h.jsxs)("button",{onClick:function(){return I(!k)},type:"button",className:"flex justify-center items-center ".concat(k&&"text-green-500"),children:[Object(h.jsx)(m.a,{icon:x.a,className:"mr-2"})," ",C.length]})]}),Object(h.jsxs)("div",{className:"".concat(!k&&"hidden"),children:[b&&C.map((function(e){return Object(h.jsx)(w,{info:e},S.a.generate())})),Object(h.jsx)(N,{post:n,afterSubmit:function(e){var c=[].concat(Object(y.a)(C),[Object(v.a)(Object(v.a)({},e),{},{user:{username:t}})]);D(c)}})]})]})},B=function(e){var t=e.username,c=Object(a.useState)({status:"cargando",data:null}),n=Object(O.a)(c,2),r=n[0],s=n[1];return Object(a.useEffect)((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var t,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("https://posts-pw2021.herokuapp.com/api/v1/post/all?limit=10&page=0",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:t=e.sent,c=t.data,s({status:"done",data:c.data});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),"cargando"===r.status?Object(h.jsx)(g,{}):Object(h.jsx)("div",{className:"flex flex-wrap mt-2 justify-center items-center",children:r.data&&r.data.map((function(e){return Object(h.jsx)(I,{username:t,struct:e},e._id)}))})},z=function(){function e(){document.getElementById("title").value="",document.getElementById("description").value="",document.getElementById("image").value=""}function t(){return(t=Object(d.a)(u.a.mark((function t(c){var a,n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.preventDefault(),a=new FormData(c.target),""!==(n=Object.fromEntries(a.entries())).title&&""!==n.description){t.next=5;break}return t.abrupt("return",Object(b.b)("Campos vacios",{type:"warning"}));case 5:return t.next=7,p.a.post("https://posts-pw2021.herokuapp.com/api/v1/post/create",Object(v.a)(Object(v.a)({},n),{},{active:"on"===n.active}),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 7:r=t.sent,console.log(r),e();case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(h.jsxs)("form",{className:"border mt-3 mb-3 px-7 py-3 rounded-md justify-center space-y-5 items-center",id:"form",onSubmit:function(e){return t.apply(this,arguments)},children:[Object(h.jsx)(b.a,{}),Object(h.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(h.jsx)("label",{htmlFor:"title",children:"Titulo: "}),Object(h.jsx)("input",{className:" border border-black rounded-md px-2",type:"text",minLength:"8",maxLength:"32",name:"title",id:"title",placeholder:"Titulo"})]}),Object(h.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(h.jsx)("label",{htmlFor:"description",children:"Descripcion: "}),Object(h.jsx)("input",{className:"border border-black rounded-md px-2",type:"text",minLength:"5",maxLength:"32",name:"description",id:"description",placeholder:"Descripcion"})]}),Object(h.jsxs)("div",{className:"flex flex-col space-y-2",children:[Object(h.jsx)("label",{htmlFor:"image",children:"Imagen: "}),Object(h.jsx)("input",{className:"border border-black rounded-md px-2",type:"text",name:"image",id:"image",placeholder:"Imagen"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:"active",children:"Activo: "}),Object(h.jsx)("input",{className:"rounded-md ml-16 form-checkbox h-7 w-7 text-green-500",type:"checkbox",name:"active",id:"active"})]}),Object(h.jsx)("button",{className:"bg-gray-400 p-2 rounded-md text-white text-center w-full",type:"submit",children:" Comentar "})]})},C=function(){var e=Object(i.g)(),t=Object(a.useState)(),c=Object(O.a)(t,2),n=c[0],r=c[1],s=localStorage.getItem("token"),o=localStorage.getItem("rol");return Object(a.useEffect)((function(){function t(){return(t=Object(d.a)(u.a.mark((function e(){var t,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("https://posts-pw2021.herokuapp.com/api/v1/auth/whoami",{headers:{Authorization:"Bearer ".concat(s)}});case 2:t=e.sent,c=t.data,r(c.username);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=s?function(){t.apply(this,arguments)}():e("/login")}),[]),Object(h.jsxs)("div",{className:"w-full",children:["admin"===o&&Object(h.jsx)("div",{className:"mt-5 flex flex-wrap justify-center items-center",children:Object(h.jsx)(z,{})}),Object(h.jsx)(B,{username:n})]})},D=function(){return Object(h.jsx)("nav",{className:"w-screen flex flex-col items-end relative",children:Object(h.jsx)("div",{className:"w-full flex justify-between items-center bg-green-500 text-white h-20",children:Object(h.jsx)("h1",{className:"pl-4 font-medium text-2xl",children:"Bienvenido"})})})},E=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(D,{}),Object(h.jsx)("div",{children:Object(h.jsx)(i.a,{})})]})},F=function(){return Object(h.jsx)(o.a,{children:Object(h.jsxs)(i.d,{children:[Object(h.jsxs)(i.b,{element:Object(h.jsx)(E,{}),children:[Object(h.jsx)(i.b,{exact:!0,path:"/",element:Object(h.jsx)(C,{})}),Object(h.jsx)(i.b,{exact:!0,path:"/post",element:Object(h.jsx)(I,{})})]}),Object(h.jsx)(i.b,{exact:!0,path:"/login",element:Object(h.jsx)(f,{})})]})})};s.a.render(Object(h.jsx)(n.a.StrictMode,{children:Object(h.jsx)(F,{})}),document.getElementById("root"))}},[[72,1,2]]]);
//# sourceMappingURL=main.655208b1.chunk.js.map